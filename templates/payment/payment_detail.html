{% extends "partials/base.html" %} {% load static %} {% block content %} <section class="inner_page_breadcrumb"> <div class="container"> <div class="row"> <div class="col-xl-6"> <div class="breadcrumb_content"> </div> </div> </div> </div> </section> <!-- Suivi de commande --> <section class="our-order-tracking pt0"> <div class="container"> <div class="row"> <div class="col-lg-6 col-xl-5 offset-xl-1"> <div class="order_tracking_content"> <div class="login_form tracking_page pt100 pt50-lg"> <h2 class="title">Choisissez le mode de paiement</h2> <input type="email" name="email" id="email" value="{{request.user.email}}"> <button id="checkout-button" class="btn btn-track btn-thm w100 mt20">Payer {{ cs }}{{object.total}} maintenant</button> </div> </div> </div> </div> </div> </section> <div class="container mt-4"> </div> <script src="https://js.stripe.com/v3/"></script> <script type="text/javascript">var stripe=Stripe('{{stripe_publishable_key}}');var checkoutButton=document.getElementById('checkout-button');checkoutButton.addEventListener('click',function(){var email=document.getElementById('email').value;if(email.length==0){alert("Veuillez saisir votre adresse e-mail.");return;}fetch("{% url 'store:api_checkout_session' id=order.oid %}",{method:'POST',body:JSON.stringify({email:email})}).then(function(response){return response.json();}).then(function(session){return stripe.redirectToCheckout({sessionId:session.sessionId});}).then(function(result){if(result.error){alert(result.error.message);}}).catch(function(error){console.error('Erreur:',error);});});</script> {% endblock content %}